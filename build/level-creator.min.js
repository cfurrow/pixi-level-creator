/*! level-creator 2013-11-28 */
(function(){var a;a=function(){function a(){}return a.prototype.isDirt=function(){return!1},a.prototype.isWater=function(){return!1},a}(),("undefined"!=typeof exports&&null!==exports?exports:this).BlockBase=a}).call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a,b){this.x=a,this.y=b,this.ui=new DirtBlockUI(this.x,this.y)}return c(b,a),b.prototype.isDirt=function(){return!0},b}(BlockBase),("undefined"!=typeof exports&&null!==exports?exports:this).DirtBlock=a}.call(this),function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=function(){function a(a,c){this.columns=a,this.rows=c,this.random=b(this.random,this),this.seed=123,this.dirtProbabilities=[.2,.3,-.1,.1],this.waterProbabilities=[.4,.1,.2,0],this.build()}return a.prototype.build=function(){var a,b;return this.blocks=function(){var c,d,e;for(e=[],a=c=0,d=this.columns;d>c;a=c+=1)e.push(function(){var c,d,e;for(e=[],b=c=0,d=this.rows;d>c;b=c+=1)e.push(this.determineBlock(a,b));return e}.call(this));return e}.call(this),this.blocks},a.prototype.blockAt=function(a,b){try{return this.blocks[a][b]}catch(c){return null}},a.prototype.random=function(){var a;return a=1e4*Math.sin(this.seed++),a-Math.floor(a)},a.prototype.updateWaterProbability=function(a,b){return this.waterProbabilities[a]=b,this.build()},a.prototype.updateDirtProbability=function(a,b){return this.dirtProbabilities[a]=b,this.build()},a.prototype.determineBlock=function(a,b){var c,d,e,f,g,h;return 0===a&&0===b?(e=Math.random(),f=Math.random(),e>f?new WaterBlock(a,b):new DirtBlock(a,b)):(d=this.blockAt(a-1,b),g=this.blockAt(a,b-1),c=.5,h=.5,d&&d.isDirt()?(c+=this.dirtProbabilities[0],h+=this.waterProbabilities[0]):(c+=this.dirtProbabilities[1],h+=this.waterProbabilities[1]),g&&g.isDirt()?(c+=this.dirtProbabilities[2],h+=this.waterProbabilities[2]):(c+=this.dirtProbabilities[3],h+=this.waterProbabilities[3]),this.random()+c>this.random()+h?new DirtBlock(a,b):new WaterBlock(a,b))},a}(),("undefined"!=typeof exports&&null!==exports?exports:this).LevelCreator=a}.call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(a,b){this.x=a,this.y=b,this.ui=new WaterBlockUI(this.x,this.y)}return c(b,a),b.prototype.isWater=function(){return!0},b}(BlockBase),("undefined"!=typeof exports&&null!==exports?exports:this).WaterBlock=a}.call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(){var a;a=PIXI.Texture.fromImage("images/dirt.png"),b.__super__.constructor.call(this,a)}return c(b,a),b}(PIXI.Sprite),("undefined"!=typeof exports&&null!==exports?exports:this).DirtBlockUI=a}.call(this),function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};a=function(a){function b(){var a;a=PIXI.Texture.fromImage("images/water.png"),b.__super__.constructor.call(this,a)}return c(b,a),b}(PIXI.Sprite),("undefined"!=typeof exports&&null!==exports?exports:this).WaterBlockUI=a}.call(this),function(){var a,b,c=function(a,b){return function(){return a.apply(b,arguments)}};b=null!=b?b:this,a=function(){function a(a){this.containerEl=a,this.animate=c(this.animate,this),this.sliderChanged=c(this.sliderChanged,this),this.creator=new LevelCreator(f/d,e/b),this.renderer=new PIXI.WebGLRenderer(f,e),this.stage=new PIXI.Stage,this.buildBlockUI(),document.body.appendChild(this.renderer.view),requestAnimationFrame(this.animate)}var b,d,e,f;return f=900,e=600,d=b=30,a.prototype.sliderChanged=function(a,b){var c,d,e,f;return d=$(b.handle),c=d.parents("li"),f=d.parents("#dirt-sliders").length>0,e=c.index(),f?this.creator.updateDirtProbability(e,b.value):this.creator.updateWaterProbability(e,b.value),this.stage=new PIXI.Stage,this.buildBlockUI()},a.prototype.buildBlockUI=function(){var a,c,e,f,g,h,i;for(a="div",i=[],f=g=0,h=this.creator.rows;h>g;f=g+=1)i.push(function(){var a,g,h;for(h=[],e=a=0,g=this.creator.columns;g>a;e=a+=1)c=this.creator.blockAt(e,f).ui,c.position.x=e*d,c.position.y=f*b,c.width=d,c.height=b,h.push(this.stage.addChild(c));return h}.call(this));return i},a.prototype.animate=function(){return this.renderer.render(this.stage),requestAnimationFrame(this.animate)},a}(),b.app=new a,$(function(){return $(".slider").slider({min:0,max:1,step:.01,slide:b.app.sliderChanged})})}.call(this);